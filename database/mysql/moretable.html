<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>多表查询 | dal-doc</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="记录生活">
    
    <link rel="preload" href="/assets/css/0.styles.e1700646.css" as="style"><link rel="preload" href="/assets/js/app.4a2d9594.js" as="script"><link rel="preload" href="/assets/js/2.b723e7b1.js" as="script"><link rel="preload" href="/assets/js/16.e2046cca.js" as="script"><link rel="prefetch" href="/assets/js/10.53d6a392.js"><link rel="prefetch" href="/assets/js/11.bb129914.js"><link rel="prefetch" href="/assets/js/12.075507c0.js"><link rel="prefetch" href="/assets/js/13.79d5632a.js"><link rel="prefetch" href="/assets/js/14.854b4683.js"><link rel="prefetch" href="/assets/js/15.b35fe5ec.js"><link rel="prefetch" href="/assets/js/17.4043a677.js"><link rel="prefetch" href="/assets/js/18.b5044167.js"><link rel="prefetch" href="/assets/js/19.344e1360.js"><link rel="prefetch" href="/assets/js/20.72c9bf00.js"><link rel="prefetch" href="/assets/js/21.9471a755.js"><link rel="prefetch" href="/assets/js/22.cb660acb.js"><link rel="prefetch" href="/assets/js/23.d97c70a3.js"><link rel="prefetch" href="/assets/js/3.536d2a59.js"><link rel="prefetch" href="/assets/js/4.f3745c7c.js"><link rel="prefetch" href="/assets/js/5.152b690a.js"><link rel="prefetch" href="/assets/js/6.ccd3a674.js"><link rel="prefetch" href="/assets/js/7.6ef38051.js"><link rel="prefetch" href="/assets/js/8.47bf155e.js"><link rel="prefetch" href="/assets/js/9.0c4cd143.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e1700646.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">dal-doc</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/java/" class="nav-link">
  java
</a></div><div class="nav-item"><a href="/database/" class="nav-link router-link-active">
  数据库
</a></div><div class="nav-item"><a href="/alg/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="https://www.jiansys.work/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  中文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  英文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/java/" class="nav-link">
  java
</a></div><div class="nav-item"><a href="/database/" class="nav-link router-link-active">
  数据库
</a></div><div class="nav-item"><a href="/alg/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="https://www.jiansys.work/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://www.baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  中文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://www.baidu.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  英文
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>数据库笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>MySql</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/database/mysql/basis.html" class="sidebar-link">MySql-基本语句</a></li><li><a href="/database/mysql/operator.html" class="sidebar-link">MySql-运算符</a></li><li><a href="/database/mysql/sort-paging.html" class="sidebar-link">MySql-排序与分页</a></li><li><a href="/database/mysql/moretable.html" aria-current="page" class="active sidebar-link">MySql-多表查询</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/database/mysql/moretable.html#_1、笛卡尔积-或交叉连接" class="sidebar-link">1、笛卡尔积（或交叉连接）</a></li><li class="sidebar-sub-header"><a href="/database/mysql/moretable.html#_2、多表查询分类讲解" class="sidebar-link">2、多表查询分类讲解</a></li><li class="sidebar-sub-header"><a href="/database/mysql/moretable.html#_3、sql92语法" class="sidebar-link">3、SQL92语法</a></li><li class="sidebar-sub-header"><a href="/database/mysql/moretable.html#_4、sql99语法" class="sidebar-link">4、SQL99语法</a></li><li class="sidebar-sub-header"><a href="/database/mysql/moretable.html#_5、sql99-7种sql-joins的实现" class="sidebar-link">5、SQL99——7种SQL JOINS的实现</a></li><li class="sidebar-sub-header"><a href="/database/mysql/moretable.html#_6、sql99语法新特性" class="sidebar-link">6、SQL99语法新特性</a></li></ul></li><li><a href="/database/mysql/single-function.html" class="sidebar-link">MySql-单行函数</a></li><li><a href="/database/mysql/aggregation-function.html" class="sidebar-link">MySql-聚合函数</a></li><li><a href="/database/mysql/subquery.html" class="sidebar-link">MySql-子查询</a></li><li><a href="/database/mysql/statement.html" class="sidebar-link">MySql-语句</a></li><li><a href="/database/mysql/function.html" class="sidebar-link">MySql-函数</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="多表查询"><a href="#多表查询" class="header-anchor">#</a> 多表查询</h1> <p>多表查询，也称为关联查询，指两个或更多个表一起完成查询操作。</p> <p>前提条件：这些一起查询的表之间是有关系的（一对一、一对多），它们之间一定是有关联字段，这个关联字段可能建立了外键，也可能没有建立外键。比如：员工表和部门表，这两个表依靠“部门编号”进行关联。</p> <h2 id="_1、笛卡尔积-或交叉连接"><a href="#_1、笛卡尔积-或交叉连接" class="header-anchor">#</a> 1、笛卡尔积（或交叉连接）</h2> <p>笛卡尔乘积是一个数学运算。假设我有两个集合 X 和 Y，那么 X 和 Y 的笛卡尔积就是 X 和 Y 的所有可能组合，也就是第一个对象来自于 X，第二个对象来自于 Y 的所有可能。组合的个数即为两个集合中元素个数的乘积数X * Y。</p> <p>SQL92中，笛卡尔积也称为交叉连接 ，英文是CROSS JOIN 。在 SQL99 中也是使用 CROSS JOIN表示交叉连接。它的作用就是可以把任意表进行连接，即使这两张表不相关。在MySQL中如下情况会出现笛卡尔积：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>#查询员工姓名和所在部门名称
<span class="token class-name">SELECT</span> last_name<span class="token punctuation">,</span>department_name <span class="token class-name">FROM</span> employees<span class="token punctuation">,</span>departments<span class="token punctuation">;</span>
<span class="token class-name">SELECT</span> last_name<span class="token punctuation">,</span>department_name FROM employees CROSS <span class="token class-name">JOIN</span> departments<span class="token punctuation">;</span>
<span class="token class-name">SELECT</span> last_name<span class="token punctuation">,</span>department_name FROM employees INNER <span class="token class-name">JOIN</span> departments<span class="token punctuation">;</span>
<span class="token class-name">SELECT</span> last_name<span class="token punctuation">,</span>department_name FROM employees <span class="token class-name">JOIN</span> departments<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>笛卡尔积的错误会在下面条件下产生：     省略多个表的连接条件（或关联条件）；</p> <p>连接条件（或关联条件）无效；</p> <p>所有表中的所有行互相连接。</p> <p>为了避免笛卡尔积， 可以在WHERE 加入有效的连接条件。</p> <p>加入连接条件后，查询语法：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>#案例：查询员工的姓名及其部门名称
<span class="token class-name">SELECT</span> last_name<span class="token punctuation">,</span> department_name
<span class="token class-name">FROM</span> employees<span class="token punctuation">,</span> departments
WHERE employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在表中有相同列时，在列名之前加上表名前缀。</p> <h2 id="_2、多表查询分类讲解"><a href="#_2、多表查询分类讲解" class="header-anchor">#</a> 2、多表查询分类讲解</h2> <p>分类1：等值连接 vs 非等值连接</p> <p>等值连接：</p> <p>多个连接条件与 AND 操作符</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>#练习：查询员工的employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name<span class="token punctuation">,</span>city
SELECT e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>d<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>l<span class="token punctuation">.</span>city<span class="token punctuation">,</span>e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>l<span class="token punctuation">.</span>location_id
FROM employees e<span class="token punctuation">,</span>departments d<span class="token punctuation">,</span>locations l
WHERE e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id AND d<span class="token punctuation">.</span>location_id <span class="token operator">=</span> l<span class="token punctuation">.</span>location_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>区分重复的列名   多个表中有相同列时，必须在列名之前加上表名前缀;</p> <p>在不同表中具有相同列名的列可以用表名加以区分。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>SELECT employees<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> departments<span class="token punctuation">.</span>department_name<span class="token punctuation">,</span>employees<span class="token punctuation">.</span>department_id
<span class="token class-name">FROM</span> employees<span class="token punctuation">,</span> departments
WHERE employees<span class="token punctuation">.</span>department_id <span class="token operator">=</span> departments<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>表的别名   使用别名可以简化查询;</p> <p>列名前使用表名前缀可以提高查询效率。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>SELECT e<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span> e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span>
d<span class="token punctuation">.</span>department_id<span class="token punctuation">,</span> d<span class="token punctuation">.</span>location_id
FROM employees e <span class="token punctuation">,</span> departments d
WHERE e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>需要注意的是，如果我们使用了表的别名，在查询字段中、过滤条件中就只能使用别名进行代替，不能使用原有的表名，否则就会报错。</p> <p>【 强制 】对于数据库中表记录的查询和变更，只要涉及多个表，都需要在列名前加表的别名（或表名）进行限定。</p> <p>说明 ：对多表进行查询记录、更新记录、删除记录时，如果对操作列没有限定表的别名（或表名），并且操作列在多个表中存在时，就会抛异常。</p> <p>正例 ：select t1.name from table_first as t1 , table_second as t2 where t1.id=t2.id;</p> <p>反例 ：在某业务中，由于多表关联查询语句没有加表的别名（或表名）的限制，正常运行两年后，最近在某个表中增加一个同名字段，在预发布环境做数据库变更后，线上查询语句出现出1052 异常：Column ‘name’ in field list is ambiguous。</p> <p>连接多个表   总结：连接 n个表,至少需要n-1个连接条件。比如，连接三个表，至少需要两个连接条件。</p> <p>非等值连接：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>SELECT e<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>e<span class="token punctuation">.</span>salary<span class="token punctuation">,</span>j<span class="token punctuation">.</span>grade_level
FROM employees e<span class="token punctuation">,</span>job_grades j
WHERE e<span class="token punctuation">.</span>salary between j<span class="token punctuation">.</span>lowest_sal and j<span class="token punctuation">.</span>highest_sal<span class="token punctuation">;</span>
#WHERE e<span class="token punctuation">.</span>`salary` <span class="token operator">&gt;=</span> j<span class="token punctuation">.</span>`lowest_sal` AND e<span class="token punctuation">.</span>`salary` <span class="token operator">&lt;=</span> j<span class="token punctuation">.</span>`highest_sal`<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>自连接 vs 非自连接</p> <p>自连接   当table1和table2本质上是同一张表，只是用取别名的方式虚拟成两张表以代表不同的意义。然后两个表再进行内连接，外连接等查询。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>#自连接的例子：
#练习：查询员工id<span class="token punctuation">,</span>员工姓名及其管理者的id和姓名

SELECT emp<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>emp<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>mgr<span class="token punctuation">.</span>last_name
FROM employees emp <span class="token punctuation">,</span>employees mgr
WHERE emp<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> mgr<span class="token punctuation">.</span>employee_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>非自连接   内连接: 合并具有同一列的两个以上的表的行, 结果集中不包含一个表与另一个表不匹配的行</p> <p>外连接: 两个表在连接过程中除了返回满足连接条件的行以外还返回左（或右）表中不满足条件的行 ，这种连接称为左（或右） 外连接。没有匹配的行时, 结果表中相应的列为空(NULL)。</p> <p>如果是左外连接，则连接条件中左边的表也称为主表，右边的表称为从表。</p> <p>如果是右外连接，则连接条件中右边的表也称为主表，左边的表称为从表。</p> <h2 id="_3、sql92语法"><a href="#_3、sql92语法" class="header-anchor">#</a> 3、SQL92语法</h2> <p>使用(+)创建连接   在 SQL92 中采用（+）代表从表所在的位置。即左或右外连接中，(+) 表示哪个是从表。</p> <p>Oracle 对 SQL92 支持较好，而 MySQL 则不支持 SQL92 的外连接。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code># <span class="token class-name">MySQL</span> 则不支持 SQL92 的外连接。
<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e<span class="token punctuation">,</span>departments d
WHERE e<span class="token punctuation">.</span>`department_id` <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">department_id</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>而且在 SQL92 中，只有左外连接和右外连接，没有满（或全）外连接。</p> <h2 id="_4、sql99语法"><a href="#_4、sql99语法" class="header-anchor">#</a> 4、SQL99语法</h2> <p>使用JOIN…ON子句创建连接的语法结构：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>SELECT table1<span class="token punctuation">.</span>column<span class="token punctuation">,</span> table2<span class="token punctuation">.</span>column<span class="token punctuation">,</span>table3<span class="token punctuation">.</span>column
FROM table1
JOIN table2 ON table1 和 table2 的连接条件
JOIN table3 ON table2 和 table3 的连接条件
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>语法说明：   可以使用 ON 子句指定额外的连接条件；</p> <p>这个连接条件是与其它条件分开的；</p> <p>ON 子句使语句具有更高的易读性；</p> <p>关键字 JOIN、INNER JOIN、CROSS JOIN 的含义是一样的，都表示内连接。</p> <h2 id="_5、sql99-7种sql-joins的实现"><a href="#_5、sql99-7种sql-joins的实现" class="header-anchor">#</a> 5、SQL99——7种SQL JOINS的实现</h2> <p><img src="https://img-blog.csdnimg.cn/eaddee7450b04240a625ed463174ac24.png#pic_center" alt="img">   1、内连接(INNER JOIN)的实现   语法：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>SELECT 字段列表
FROM <span class="token class-name">A</span>表 INNER JOIN <span class="token class-name">B</span>表
ON 关联条件
WHERE 等其他子句<span class="token punctuation">;</span>

# 中图：内连接
<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>外连接(OUTER JOIN)的实现     2、左外连接(LEFT OUTER JOIN)     语法：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>#实现查询结果是<span class="token class-name">A</span>
SELECT 字段列表
FROM <span class="token class-name">A</span>表 LEFT JOIN <span class="token class-name">B</span>表
ON 关联条件
WHERE 等其他子句<span class="token punctuation">;</span>

# 左上图：左外连接
<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e LEFT JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>3、右外连接(RIGHT OUTER JOIN)     语法：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>SELECT 字段列表
FROM <span class="token class-name">A</span>表 RIGHT JOIN <span class="token class-name">B</span>表
ON 关联条件
WHERE 等其他子句<span class="token punctuation">;</span>

# 右上图：右外连接
<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e RIGHT JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>需要注意的是，LEFT JOIN 和 RIGHT JOIN 只存在于 SQL99 及以后的标准中，在 SQL92 中不存在，只能用 (+) 表示。</p> <p>4、满外连接(FULL OUTER JOIN)     满外连接的结果 = 左右表匹配的数据 + 左表没有匹配到的数据 + 右表没有匹配到的数据。</p> <p>SQL99是支持满外连接的。使用FULL JOIN 或 FULL OUTER JOIN来实现。</p> <p>需要注意的是，MySQL不支持FULL JOIN，但是可以用 LEFT JOIN UNION RIGHT join代替。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>#满外连接：mysql不支持FULL OUTER JOIN
<span class="token class-name">SELECT</span> last_name<span class="token punctuation">,</span>department_name
FROM employees e FULL OUTER JOIN departments d
ON e<span class="token punctuation">.</span>`department_id` <span class="token operator">=</span> d<span class="token punctuation">.</span>`department_id`<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code># 左下图：满外连接
# 方式<span class="token number">1</span>：左上图 UNION ALL 右中图

<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e LEFT JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
UNION ALL
<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e RIGHT JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
WHERE e<span class="token punctuation">.</span>`department_id` <span class="token class-name">IS</span> NULL<span class="token punctuation">;</span>

# 方式<span class="token number">2</span>：左中图 UNION ALL 右上图

<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e LEFT JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
WHERE d<span class="token punctuation">.</span>department_id IS NULL
UNION ALL
<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e RIGHT JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>UNION的使用   合并查询结果 利用UNION关键字，可以给出多条SELECT语句，并将它们的结果组合成单个结果集。合并时，两个表对应的列数和数据类型必须相同，并且相互对应。各个SELECT语句之间使用UNION或UNIONALL关键字分隔。</p> <p>语法格式：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">SELECT</span> column<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> FROM table1
UNION <span class="token punctuation">[</span>ALL<span class="token punctuation">]</span>
<span class="token class-name">SELECT</span> column<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> FROM table2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>UNION操作符   UNION 操作符返回两个查询的结果集的并集，去除重复记录。</p> <p>UNION ALL操作符——尽量多用（效率高）   UNION ALL操作符返回两个查询的结果集的并集。对于两个结果集的重复部分，不去重。</p> <p>注意：执行UNION ALL语句时所需要的资源比UNION语句少。如果明确知道合并数据后的结果数据不存在重复数据，或者不需要去除重复的数据，则尽量使用UNION ALL语句，以提高数据查询的效率。</p> <p>5、</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code># 左中图：
<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e LEFT JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
#中间的共同区域是department_id <span class="token class-name">I</span>不为NULL的，要实现左中图就可以只选择department_id <span class="token class-name">I</span>为NULL的
WHERE d<span class="token punctuation">.</span>department_id <span class="token class-name">IS</span> NULL<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>6、</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code># 右中图：
<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e RIGHT JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
#中间的共同区域是department_id <span class="token class-name">I</span>不为NULL的，要实现右中图就可以用右外连接后，只选择department_id 为NULL的
WHERE e<span class="token punctuation">.</span>department_id <span class="token class-name">IS</span> NULL<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>7、</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code># 右下图：左中图  UNION ALL 右中图
<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e LEFT JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
WHERE d<span class="token punctuation">.</span>department_id IS NULL
UNION ALL
<span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>department_name
FROM employees e RIGHT JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
WHERE e<span class="token punctuation">.</span>department_id <span class="token class-name">IS</span> NULL<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_6、sql99语法新特性"><a href="#_6、sql99语法新特性" class="header-anchor">#</a> 6、SQL99语法新特性</h2> <p>自然连接   SQL99 在 SQL92 的基础上提供了一些特殊语法，比如NATURAL JOIN用来表示自然连接。我们可以把自然连接理解为 SQL92 中的等值连接。它会帮你自动查询两张连接表中所有相同的字段，然后进行等值连接。</p> <p>在SQL92标准中：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
FROM employees e JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id
AND e<span class="token punctuation">.</span>manager_id <span class="token operator">=</span> d<span class="token punctuation">.</span>manager_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在 SQL99 中你可以写成：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
FROM employees e NATURAL JOIN departments d<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>USING连接   当我们进行连接的时候，SQL99还支持使用 USING 指定数据表里的同名字段进行等值连接。但是只能配合JOIN一起使用。比如：   在SQL92标准中：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
FROM employees e JOIN departments d
ON e<span class="token punctuation">.</span>department_id <span class="token operator">=</span> d<span class="token punctuation">.</span>department_id<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在 SQL99 中你可以写成：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">SELECT</span> employee_id<span class="token punctuation">,</span>last_name<span class="token punctuation">,</span>department_name
FROM employees e JOIN departments d
USING <span class="token punctuation">(</span>department_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/database/mysql/sort-paging.html" class="prev">
        MySql-排序与分页
      </a></span> <span class="next"><a href="/database/mysql/single-function.html">
        MySql-单行函数
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4a2d9594.js" defer></script><script src="/assets/js/2.b723e7b1.js" defer></script><script src="/assets/js/16.e2046cca.js" defer></script>
  </body>
</html>
